---
const { images, containerId = 'photo-carousel', imageId = 'carousel-image' } = Astro.props;
---

<div class="relative flex justify-center my-16">
  <div id={containerId} class="relative transform lg:rotate-2 transition-none w-full max-w-3xl">
    <img
      id={imageId}
      src={images[0]}
      alt="Workshop participants collaborating on EventStorming"
      class="w-full aspect-[4/3] object-cover rounded-3xl shadow-2xl border border-white/10 transition-opacity duration-500"
      loading="lazy"
    />
  </div>
</div>

<script define:vars={{ images, containerId, imageId }}>
  const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

  if (!prefersReducedMotion) {
    let currentIndex = 0;
    const imgElement = document.getElementById(imageId);
    const containerElement = document.getElementById(containerId);

    setInterval(() => {
      currentIndex = (currentIndex + 1) % images.length;
      if (imgElement && containerElement) {
        imgElement.style.opacity = '0';

        setTimeout(() => {
          const rotation = currentIndex % 2 === 0 ? 'rotate(2deg)' : 'rotate(-2deg)';
          containerElement.style.transform = rotation;

          imgElement.src = images[currentIndex];
          imgElement.style.opacity = '1';
        }, 500);
      }
    }, 5000);
  }
</script>
